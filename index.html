
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The documentation for cryoJAX.">
      
      
        <meta name="author" content="Michael O'Brien">
      
      
        <link rel="canonical" href="https://mjo22.github.io/cryojax/">
      
      
      
        <link rel="next" href="examples/simulate-image.ipynb">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.15">
    
    
      
        <title>cryoJAX</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="_static/custom_css.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#welcome-to-cryojax" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="cryoJAX" class="md-header__button md-logo" aria-label="cryoJAX" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20.79 13.95-2.33.62-2-1.13v-2.88l2-1.13 2.33.62.52-1.93-1.77-.47.46-1.77-1.93-.52-.62 2.33-2 1.13L13 7.38V5.12l1.71-1.71L13.29 2 12 3.29 10.71 2 9.29 3.41 11 5.12v2.26L8.5 8.82l-2-1.13-.58-2.33L4 5.88l.47 1.77-1.77.47.52 1.93 2.33-.62 2 1.13v2.89l-2 1.13-2.33-.62-.52 1.93 1.77.47L4 18.12l1.93.52.62-2.33 2-1.13L11 16.62v2.26l-1.71 1.71L10.71 22 12 20.71 13.29 22l1.41-1.41-1.7-1.71v-2.26l2.5-1.45 2 1.13.62 2.33 1.88-.51-.47-1.77 1.77-.47-.51-1.93M9.5 10.56 12 9.11l2.5 1.45v2.88L12 14.89l-2.5-1.45v-2.88Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            cryoJAX
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Welcome to cryoJAX!
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/mjo22/cryojax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mjo22/cryojax
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="cryoJAX" class="md-nav__button md-logo" aria-label="cryoJAX" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20.79 13.95-2.33.62-2-1.13v-2.88l2-1.13 2.33.62.52-1.93-1.77-.47.46-1.77-1.93-.52-.62 2.33-2 1.13L13 7.38V5.12l1.71-1.71L13.29 2 12 3.29 10.71 2 9.29 3.41 11 5.12v2.26L8.5 8.82l-2-1.13-.58-2.33L4 5.88l.47 1.77-1.77.47.52 1.93 2.33-.62 2 1.13v2.89l-2 1.13-2.33-.62-.52 1.93 1.77.47L4 18.12l1.93.52.62-2.33 2-1.13L11 16.62v2.26l-1.71 1.71L10.71 22 12 20.71 13.29 22l1.41-1.41-1.7-1.71v-2.26l2.5-1.45 2 1.13.62 2.33 1.88-.51-.47-1.77 1.77-.47-.51-1.93M9.5 10.56 12 9.11l2.5 1.45v2.88L12 14.89l-2.5-1.45v-2.88Z"/></svg>

    </a>
    cryoJAX
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mjo22/cryojax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mjo22/cryojax
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Welcome to cryoJAX!
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Welcome to cryoJAX!
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-example" class="md-nav__link">
    <span class="md-ellipsis">
      Quick example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span class="md-ellipsis">
      Acknowledgements
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introductory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Introductory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples/simulate-image.ipynb" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulate an image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples/read-dataset.ipynb" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read a particle stack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Intermediate
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Intermediate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples/simulate-micrograph.ipynb" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulate a batch of images
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Simulator API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Simulator API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/simulator/scattering_potential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scattering potential representations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="welcome-to-cryojax">Welcome to cryoJAX!<a class="headerlink" href="#welcome-to-cryojax" title="Permanent link">¤</a></h1>
<p>cryoJAX is a library that provides tools for simulating and analyzing cryo-electron microscopy (cryo-EM) images. It is built on <a href="https://jax.readthedocs.io/en/latest/"><code>jax</code></a>.</p>
<p>Specifically, cryoJAX aims to provide three things in the cryo-EM image-to-structure pipeline.</p>
<ol>
<li><em>Physical modeling of image formation</em></li>
<li><em>Statistical modeling of the distributions from which images are drawn</em></li>
<li><em>Easy-to-use utilities for working with real data</em></li>
</ol>
<p>With these tools, <code>cryojax</code> aims to appeal to two different communities. Experimentalists can use <code>cryojax</code> in order to push the boundaries of what they can extract from their data by interfacing with the <code>jax</code> scientific computing ecosystem. Additionally, method developers may use <code>cryojax</code> as a backend for an algorithmic research project, such as in cryo-EM structure determination. These two aims are possible because <code>cryojax</code> is written to be fully interoperable with anything else in the JAX ecosystem.</p>
<p>Dig a little deeper and you'll find that <code>cryojax</code> aims to be a fully extensible modeling language for cryo-EM image formation. It implements a collection of abstract interfaces, which aim to be general enough to support any level of modeling complexity—from simple linear image formation to the most realistic physical models in the field. Best of all, these interfaces are all part of the public API. Users can create their own extensions to <code>cryojax</code>, tailored to their specific use-case!</p>
<p>This documentation is currently a work-in-progress. Your patience while we get this project properly documented is much appreciated! Feel free to get in touch on github <a href="https://github.com/mjo22/cryojax/issues">issues</a> if you have any questions, bug reports, or feature requests.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">¤</a></h2>
<p>Installing <code>cryojax</code> is simple. To start, I recommend creating a new virtual environment. For example, you could do this with <code>conda</code>.</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>cryojax-env<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.11
</code></pre></div>
<p>Note that <code>python&gt;=3.10</code> is required. After creating a new environment, <a href="https://github.com/google/jax#installation">install JAX</a> with either CPU or GPU support. Then, install <code>cryojax</code>. For the latest stable release, install using <code>pip</code>.</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>cryojax
</code></pre></div>
<p>To install the latest commit, you can build the repository directly.</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/mjo22/cryojax
<span class="nb">cd</span><span class="w"> </span>cryojax
python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>.
</code></pre></div>
<p>The <a href="https://github.com/dfm/jax-finufft"><code>jax-finufft</code></a> package is an optional dependency used for non-uniform fast fourier transforms. These are included as an option for computing image projections of real-space voxel-based scattering potential representations. In this case, we recommend first following the <code>jax_finufft</code> installation instructions and then installing <code>cryojax</code>.</p>
<h2 id="quick-example">Quick example<a class="headerlink" href="#quick-example" title="Permanent link">¤</a></h2>
<p>The following is a basic workflow to simulate an image.</p>
<p>First, instantiate the scattering potential representation and its respective method for computing image projections.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">cryojax.simulator</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="kn">from</span> <span class="nn">cryojax.io</span> <span class="kn">import</span> <span class="n">read_array_with_spacing_from_mrc</span>

<span class="c1"># Instantiate the scattering potential.</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;example_scattering_potential.mrc&quot;</span>
<span class="n">real_voxel_grid</span><span class="p">,</span> <span class="n">voxel_size</span> <span class="o">=</span> <span class="n">read_array_with_spacing_from_mrc</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">FourierVoxelGridPotential</span><span class="o">.</span><span class="n">from_real_voxel_grid</span><span class="p">(</span><span class="n">real_voxel_grid</span><span class="p">,</span> <span class="n">voxel_size</span><span class="p">)</span>
<span class="c1"># ... now instantiate fourier slice extraction</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">FourierSliceExtract</span><span class="p">(</span><span class="n">interpolation_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>Here, the 3D scattering potential array is read from <code>filename</code>. Then, the abstraction of the scattering potential is then loaded in fourier-space into a <code>FourierVoxelGridPotential</code>, and the fourier-slice projection theorem is initialized with <code>FourierSliceExtract</code>. The scattering potential can be generated with an external program, such as the <a href="https://github.com/timothygrant80/cisTEM">cisTEM</a> simulate tool.</p>
<p>We can now instantiate the representation of a biological specimen, which also includes a pose.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># First instantiate the pose. Angles are given in degrees</span>
<span class="n">pose</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">EulerAnglePose</span><span class="p">(</span>
    <span class="n">offset_x_in_angstroms</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">offset_y_in_angstroms</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span>
    <span class="n">view_phi</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span>
    <span class="n">view_theta</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span>
    <span class="n">view_psi</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># ... now, build the biological specimen</span>
<span class="n">specimen</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">Specimen</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">integrator</span><span class="p">,</span> <span class="n">pose</span><span class="p">)</span>
</code></pre></div>
<p>Next, build the model for the electron microscope. Here, we simply include a model for the CTF in the weak-phase approximation (linear image formation theory).</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">cryojax.image</span> <span class="kn">import</span> <span class="n">operators</span> <span class="k">as</span> <span class="n">op</span>

<span class="c1"># First, initialize the CTF and its optics model</span>
<span class="n">ctf</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">CTF</span><span class="p">(</span>
    <span class="n">defocus_u_in_angstroms</span><span class="o">=</span><span class="mf">10000.0</span><span class="p">,</span>
    <span class="n">defocus_v_in_angstroms</span><span class="o">=</span><span class="mf">9800.0</span><span class="p">,</span>
    <span class="n">astigmatism_angle</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">voltage_in_kilovolts</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span>
    <span class="n">amplitude_contrast_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">optics</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">WeakPhaseOptics</span><span class="p">(</span><span class="n">ctf</span><span class="p">,</span> <span class="n">envelope</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">FourierGaussian</span><span class="p">(</span><span class="n">b_factor</span><span class="o">=</span><span class="mf">5.0</span><span class="p">))</span>  <span class="c1"># b_factor is given in Angstroms^2</span>
<span class="c1"># ... these are stored in the Instrument</span>
<span class="n">instrument</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">Instrument</span><span class="p">(</span><span class="n">optics</span><span class="p">)</span>
</code></pre></div>
<p>The <code>CTF</code> has all parameters used in CTFFIND4, which take their default values if not
explicitly configured here. Finally, we can instantiate the <code>ImagePipeline</code> and simulate an image.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Instantiate the image configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">ImageConfig</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">320</span><span class="p">),</span> <span class="n">pixel_size</span><span class="o">=</span><span class="n">voxel_size</span><span class="p">)</span>
<span class="c1"># Build the image formation model</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">ImagePipeline</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">specimen</span><span class="p">,</span> <span class="n">instrument</span><span class="p">)</span>
<span class="c1"># ... simulate an image and return a normalized image in real-space</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">get_real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<h2 id="next-steps">Next steps<a class="headerlink" href="#next-steps" title="Permanent link">¤</a></h2>
<p>There are many modeling features in <code>cryojax</code> to learn about. To learn more, see the Examples section of the documentation.</p>
<h2 id="acknowledgements">Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permanent link">¤</a></h2>
<ul>
<li><code>cryojax</code> has been greatly informed by the open-source cryo-EM softwares <a href="https://github.com/timothygrant80/cisTEM"><code>cisTEM</code></a> and <a href="https://github.com/bio-phys/BioEM"><code>BioEM</code></a>.</li>
<li><code>cryojax</code> relies heavily on and has taken great inspiration from <a href="https://github.com/patrick-kidger/equinox/"><code>equinox</code></a>. We think that <code>equinox</code> has great design principles and highly recommend learning about it to fully make use of the power of <code>jax</code>.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.sections", "toc.integrate"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.bd41221c.min.js"></script>
      
        <script src="javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>